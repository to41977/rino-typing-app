<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„É™„ÉéÂ∞ÇÁî®„Çø„Ç§„Éî„É≥„Ç∞„ÇΩ„Éï„Éà</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #6a1b9a;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #8e24aa;
        }

        .game-panel {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
            display: none;
        }

        .game-panel.active {
            display: block;
        }

        .difficulty-panel {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
        }

        .difficulty-title {
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            color: #333;
        }

        .difficulty-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .difficulty-btn {
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: #e0e0e0;
            color: #666;
        }

        .difficulty-btn:hover {
            transform: translateY(-2px);
        }

        .difficulty-btn.easy {
            background: #4caf50;
            color: white;
        }

        .difficulty-btn.medium {
            background: #ff9800;
            color: white;
        }

        .difficulty-btn.hard {
            background: #f44336;
            color: white;
        }

        .difficulty-btn.selected {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .score-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .score-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .score-item.score {
            color: #6a1b9a;
        }

        .score-item.correct {
            color: #1976d2;
        }

        .lives-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .hearts {
            display: flex;
            gap: 5px;
        }

        .heart {
            font-size: 1.5rem;
            color: #e0e0e0;
        }

        .heart.active {
            color: #e91e63;
        }

        .timer {
            font-size: 1.5rem;
            font-weight: bold;
            color: #6a1b9a;
        }

        .word-display {
            text-align: center;
            margin-bottom: 30px;
        }

        .current-word {
            font-size: 4rem;
            font-weight: bold;
            color: #6a1b9a;
            margin-bottom: 15px;
        }

        .instruction {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 15px;
        }

        .romaji-display {
            font-size: 2rem;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 15px;
        }

        .input-area {
            text-align: center;
            margin-bottom: 20px;
        }

        .typing-input {
            font-size: 2rem;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-align: center;
            padding: 15px;
            border: 4px solid #e0e0e0;
            border-radius: 10px;
            width: 100%;
            max-width: 400px;
            outline: none;
            transition: all 0.3s;
        }

        .typing-input.correct {
            border-color: #4caf50;
            background: #e8f5e8;
        }

        .typing-input.wrong {
            border-color: #f44336;
            background: #ffebee;
        }

        .input-preview {
            font-size: 1.5rem;
            font-family: 'Courier New', monospace;
            margin-top: 15px;
            min-height: 2rem;
        }

        .preview-correct {
            color: #4caf50;
        }

        .preview-wrong {
            color: #f44336;
        }

        .preview-remaining {
            color: #ccc;
        }

        .result-panel {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
            text-align: center;
            display: none;
        }

        .result-panel.active {
            display: block;
        }

        .result-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #6a1b9a;
            margin-bottom: 15px;
        }

        .result-emoji {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .result-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-item {
            padding: 20px;
            border-radius: 10px;
        }

        .stat-item.score-stat {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .stat-item.correct-stat {
            background: #e3f2fd;
            color: #1565c0;
        }

        .stat-label {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
        }

        .accuracy {
            font-size: 1.2rem;
            color: #666;
            margin-bottom: 20px;
        }

        .control-buttons {
            text-align: center;
        }

        .control-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.3rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .start-btn {
            background: #6a1b9a;
            color: white;
        }

        .start-btn:hover {
            background: #4a148c;
            transform: translateY(-2px);
        }

        .end-btn {
            background: #f44336;
            color: white;
        }

        .end-btn:hover {
            background: #d32f2f;
            transform: translateY(-2px);
        }

        .restart-btn {
            background: #4caf50;
            color: white;
        }

        .restart-btn:hover {
            background: #388e3c;
            transform: translateY(-2px);
        }

        @media (max-width: 600px) {
            .title {
                font-size: 2rem;
            }
            
            .current-word {
                font-size: 3rem;
            }
            
            .typing-input {
                font-size: 1.5rem;
            }
            
            .difficulty-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .difficulty-btn {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- „Éò„ÉÉ„ÉÄ„Éº -->
        <div class="header">
            <h1 class="title">üéØ „É™„ÉéÂ∞ÇÁî®„Çø„Ç§„Éî„É≥„Ç∞„ÇΩ„Éï„Éà</h1>
            <p class="subtitle">„Å≤„Çâ„Åå„Å™„Çí„É≠„Éº„ÉûÂ≠ó„Åß„Çø„Ç§„Éî„É≥„Ç∞„Åó„Çà„ÅÜÔºÅ</p>
        </div>

        <!-- Èõ£ÊòìÂ∫¶ÈÅ∏Êäû„Éë„Éç„É´ -->
        <div class="difficulty-panel" id="difficultyPanel">
            <h2 class="difficulty-title">Èõ£ÊòìÂ∫¶„ÇíÈÅ∏„Çì„Åß„Å≠</h2>
            <div class="difficulty-buttons">
                <button class="difficulty-btn easy selected" data-difficulty="easy">
                    „Åã„Çì„Åü„ÇìÔºà„ÅÇ„ÅÑ„ÅÜ„Åà„ÅäÔºâ
                </button>
                <button class="difficulty-btn medium" data-difficulty="medium">
                    „Åµ„Å§„ÅÜÔºà„Åü„Çì„ÅîÔºâ
                </button>
                <button class="difficulty-btn hard" data-difficulty="hard">
                    „ÇÄ„Åö„Åã„Åó„ÅÑÔºà„Å™„Åå„Äú„ÅÑÔºâ
                </button>
            </div>
        </div>

        <!-- „Ç≤„Éº„É†ÁîªÈù¢ -->
        <div class="game-panel" id="gamePanel">
            <!-- „Çπ„ÉÜ„Éº„Çø„Çπ„Éê„Éº -->
            <div class="status-bar">
                <div class="score-group">
                    <div class="score-item score">
                        <span>‚≠ê</span>
                        <span id="scoreDisplay">0</span>
                    </div>
                    <div class="score-item correct">
                        <span>üèÜ</span>
                        <span id="correctDisplay">0</span>
                    </div>
                </div>
                <div class="lives-group">
                    <div class="hearts" id="heartsDisplay">
                        <span class="heart active">‚ù§Ô∏è</span>
                        <span class="heart active">‚ù§Ô∏è</span>
                        <span class="heart active">‚ù§Ô∏è</span>
                    </div>
                    <div class="timer">
                        ‚è∞ <span id="timerDisplay">60</span>
                    </div>
                </div>
            </div>

            <!-- ÂïèÈ°åË°®Á§∫ -->
            <div class="word-display">
                <div class="current-word" id="currentWord">„ÅÇ</div>
                <div class="instruction">‚Üì „É≠„Éº„ÉûÂ≠ó„ÅßÂÖ•Âäõ„Åó„Å¶„Å≠ ‚Üì</div>
                <div class="romaji-display" id="romajiDisplay">a</div>
            </div>

            <!-- ÂÖ•Âäõ„Ç®„É™„Ç¢ -->
            <div class="input-area">
                <input type="text" class="typing-input" id="typingInput" placeholder="„Åì„Åì„Å´„Çø„Ç§„Éî„É≥„Ç∞" autocomplete="off">
                <div class="input-preview" id="inputPreview"></div>
            </div>
        </div>

        <!-- ÁµêÊûú„Éë„Éç„É´ -->
        <div class="result-panel" id="resultPanel">
            <h2 class="result-title" id="resultTitle">„Åô„Å∞„Çâ„Åó„ÅÑÔºÅ</h2>
            <div class="result-emoji">üéâ</div>
            <div class="result-stats">
                <div class="stat-item score-stat">
                    <div class="stat-label">„Çπ„Ç≥„Ç¢</div>
                    <div class="stat-value" id="finalScore">0</div>
                </div>
                <div class="stat-item correct-stat">
                    <div class="stat-label">Ê≠£Ëß£Êï∞</div>
                    <div class="stat-value" id="finalCorrect">0</div>
                </div>
            </div>
            <div class="accuracy" id="accuracyDisplay">Ê≠£Ëß£Áéá: 0%</div>
        </div>

        <!-- Êìç‰Ωú„Éú„Çø„É≥ -->
        <div class="control-buttons">
            <button class="control-btn start-btn" id="startBtn">
                <span>‚ñ∂Ô∏è</span>
                <span>„Ç≤„Éº„É†„Çπ„Çø„Éº„Éà</span>
            </button>
            <button class="control-btn end-btn" id="endBtn" style="display: none;">
                <span>‚è∏Ô∏è</span>
                <span>„Ç≤„Éº„É†ÁµÇ‰∫Ü</span>
            </button>
            <button class="control-btn restart-btn" id="restartBtn" style="display: none;">
                <span>üîÑ</span>
                <span>„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÇÑ„Çã</span>
            </button>
        </div>
    </div>

    <script>
        // „Ç≤„Éº„É†Áä∂ÊÖã
        let gameState = {
            currentWord: '',
            romaji: '',
            userInput: '',
            score: 0,
            lives: 3,
            gameActive: false,
            timeLeft: 60,
            correctCount: 0,
            wrongCount: 0,
            difficulty: 'easy',
            timer: null
        };

        // ÂçòË™û„É™„Çπ„Éà
        const wordLists = {
            easy: [
                { hiragana: '„ÅÇ', romaji: 'a' },
                { hiragana: '„ÅÑ', romaji: 'i' },
                { hiragana: '„ÅÜ', romaji: 'u' },
                { hiragana: '„Åà', romaji: 'e' },
                { hiragana: '„Åä', romaji: 'o' },
                { hiragana: '„Åã', romaji: 'ka' },
                { hiragana: '„Åç', romaji: 'ki' },
                { hiragana: '„Åè', romaji: 'ku' },
                { hiragana: '„Åë', romaji: 'ke' },
                { hiragana: '„Åì', romaji: 'ko' },
                { hiragana: '„Åï', romaji: 'sa' },
                { hiragana: '„Åó', romaji: 'shi' },
                { hiragana: '„Åô', romaji: 'su' },
                { hiragana: '„Åõ', romaji: 'se' },
                { hiragana: '„Åù', romaji: 'so' }
            ],
            medium: [
                { hiragana: '„Åü„Åæ„Åî', romaji: 'tamago' },
                { hiragana: '„Å≠„Åì', romaji: 'neko' },
                { hiragana: '„ÅÑ„Å¨', romaji: 'inu' },
                { hiragana: '„ÅØ„Å™', romaji: 'hana' },
                { hiragana: '„Åù„Çâ', romaji: 'sora' },
                { hiragana: '„Åø„Åö', romaji: 'mizu' },
                { hiragana: '„ÇÑ„Åæ', romaji: 'yama' },
                { hiragana: '„ÅÜ„Åø', romaji: 'umi' },
                { hiragana: '„Åã„Çè', romaji: 'kawa' },
                { hiragana: '„Å§„Åç', romaji: 'tsuki' }
            ],
            hard: [
                { hiragana: '„Åå„Å£„Åì„ÅÜ', romaji: 'gakkou' },
                { hiragana: '„Åõ„Çì„Åõ„ÅÑ', romaji: 'sensei' },
                { hiragana: '„Å®„ÇÇ„Å†„Å°', romaji: 'tomodachi' },
                { hiragana: '„Åò„Å¶„Çì„Åó„ÇÉ', romaji: 'jitensha' },
                { hiragana: '„Åß„Çì„Åó„ÇÉ', romaji: 'densha' },
                { hiragana: '„Å≤„Åì„ÅÜ„Åç', romaji: 'hikouki' },
                { hiragana: '„Åπ„Çì„Åç„Çá„ÅÜ', romaji: 'benkyou' },
                { hiragana: '„Åó„ÇÖ„Åè„Å†„ÅÑ', romaji: 'shukudai' },
                { hiragana: '„Å®„Åó„Çá„Åã„Çì', romaji: 'toshokan' },
                { hiragana: '„Å≥„Çá„ÅÜ„ÅÑ„Çì', romaji: 'byouin' }
            ]
        };

        // DOMË¶ÅÁ¥†„ÇíÂèñÂæó
        const elements = {
            difficultyPanel: document.getElementById('difficultyPanel'),
            gamePanel: document.getElementById('gamePanel'),
            resultPanel: document.getElementById('resultPanel'),
            startBtn: document.getElementById('startBtn'),
            endBtn: document.getElementById('endBtn'),
            restartBtn: document.getElementById('restartBtn'),
            typingInput: document.getElementById('typingInput'),
            currentWord: document.getElementById('currentWord'),
            romajiDisplay: document.getElementById('romajiDisplay'),
            scoreDisplay: document.getElementById('scoreDisplay'),
            correctDisplay: document.getElementById('correctDisplay'),
            timerDisplay: document.getElementById('timerDisplay'),
            heartsDisplay: document.getElementById('heartsDisplay'),
            inputPreview: document.getElementById('inputPreview'),
            resultTitle: document.getElementById('resultTitle'),
            finalScore: document.getElementById('finalScore'),
            finalCorrect: document.getElementById('finalCorrect'),
            accuracyDisplay: document.getElementById('accuracyDisplay')
        };

        // Èõ£ÊòìÂ∫¶ÈÅ∏Êäû
        document.querySelectorAll('.difficulty-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('selected'));
                btn.classList.add('selected');
                gameState.difficulty = btn.dataset.difficulty;
            });
        });

        // Êñ∞„Åó„ÅÑÂçòË™û„ÇíÈÅ∏Êäû
        function selectNewWord() {
            const words = wordLists[gameState.difficulty];
            const randomIndex = Math.floor(Math.random() * words.length);
            const word = words[randomIndex];
            gameState.currentWord = word.hiragana;
            gameState.romaji = word.romaji;
            gameState.userInput = '';
            
            elements.currentWord.textContent = gameState.currentWord;
            elements.romajiDisplay.textContent = gameState.romaji;
            elements.typingInput.value = '';
            updateInputPreview();
        }

        // „Ç≤„Éº„É†ÈñãÂßã
        function startGame() {
            gameState.gameActive = true;
            gameState.score = 0;
            gameState.lives = 3;
            gameState.timeLeft = 60;
            gameState.correctCount = 0;
            gameState.wrongCount = 0;
            
            elements.difficultyPanel.style.display = 'none';
            elements.gamePanel.classList.add('active');
            elements.resultPanel.classList.remove('active');
            elements.startBtn.style.display = 'none';
            elements.endBtn.style.display = 'inline-flex';
            elements.restartBtn.style.display = 'none';
            
            selectNewWord();
            updateDisplay();
            elements.typingInput.focus();
            
            // „Çø„Ç§„Éû„ÉºÈñãÂßã
            gameState.timer = setInterval(() => {
                gameState.timeLeft--;
                updateDisplay();
                if (gameState.timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        // „Ç≤„Éº„É†ÁµÇ‰∫Ü
        function endGame() {
            gameState.gameActive = false;
            clearInterval(gameState.timer);
            
            elements.gamePanel.classList.remove('active');
            elements.resultPanel.classList.add('active');
            elements.endBtn.style.display = 'none';
            elements.restartBtn.style.display = 'inline-flex';
            
            showResult();
        }

        // ÁµêÊûúË°®Á§∫
        function showResult() {
            const accuracy = gameState.correctCount + gameState.wrongCount > 0 
                ? Math.round((gameState.correctCount / (gameState.correctCount + gameState.wrongCount)) * 100) 
                : 0;
            
            let message = '„Å§„Åé„ÅØ„ÇÇ„Å£„Å®„Åå„Çì„Å∞„Çç„ÅÜÔºÅ';
            if (accuracy >= 80) message = '„Åô„Å∞„Çâ„Åó„ÅÑÔºÅ';
            else if (accuracy >= 60) message = '„Åå„Çì„Å∞„Çä„Åæ„Åó„ÅüÔºÅ';
            
            elements.resultTitle.textContent = message;
            elements.finalScore.textContent = gameState.score;
            elements.finalCorrect.textContent = gameState.correctCount;
            elements.accuracyDisplay.textContent = `Ê≠£Ëß£Áéá: ${accuracy}%`;
        }

        // ÁîªÈù¢Êõ¥Êñ∞
        function updateDisplay() {
            elements.scoreDisplay.textContent = gameState.score;
            elements.correctDisplay.textContent = gameState.correctCount;
            elements.timerDisplay.textContent = gameState.timeLeft;
            
            // „Éè„Éº„ÉàË°®Á§∫Êõ¥Êñ∞
            const hearts = elements.heartsDisplay.querySelectorAll('.heart');
            hearts.forEach((heart, index) => {
                heart.className = index < gameState.lives ? 'heart active' : 'heart';
            });
        }

        // ÂÖ•Âäõ„Éó„É¨„Éì„É•„ÉºÊõ¥Êñ∞
        function updateInputPreview() {
            const input = gameState.userInput.toLowerCase();
            const target = gameState.romaji;
            let preview = '';
            
            for (let i = 0; i < Math.max(input.length, target.length); i++) {
                if (i < input.length) {
                    if (i < target.length && input[i] === target[i]) {
                        preview += `<span class="preview-correct">${input[i]}</span>`;
                    } else {
                        preview += `<span class="preview-wrong">${input[i]}</span>`;
                    }
                } else {
                    preview += `<span class="preview-remaining">${target[i]}</span>`;
                }
            }
            
            elements.inputPreview.innerHTML = preview;
        }

        // ÂÖ•Âäõ„ÉÅ„Çß„ÉÉ„ÇØ
        function checkInput() {
            const input = gameState.userInput.toLowerCase();
            const target = gameState.romaji;
            
            if (input === target) {
                // Ê≠£Ëß£
                gameState.score += 10;
                gameState.correctCount++;
                selectNewWord();
                updateDisplay();
            } else if (input.length > target.length) {
                // ÈñìÈÅï„ÅÑ
                gameState.lives--;
                gameState.wrongCount++;
                gameState.userInput = '';
                elements.typingInput.value = '';
                updateInputPreview();
                updateDisplay();
                
                if (gameState.lives <= 0) {
                    endGame();
                }
            }
        }

        // ÂÖ•ÂäõÁä∂ÊÖã„ÅÆË¶ñË¶ö„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ
        function updateInputStyle() {
            const input = gameState.userInput.toLowerCase();
            const target = gameState.romaji;
            
            if (input === '') {
                elements.typingInput.className = 'typing-input';
            } else if (target.startsWith(input)) {
                elements.typingInput.className = 'typing-input correct';
            } else {
                elements.typingInput.className = 'typing-input wrong';
            }
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        elements.startBtn.addEventListener('click', startGame);
        elements.endBtn.addEventListener('click', endGame);
        elements.restartBtn.addEventListener('click', () => {
            elements.resultPanel.classList.remove('active');
            elements.difficultyPanel.style.display = 'block';
            elements.startBtn.style.display = 'inline-flex';
            elements.restartBtn.style.display = 'none';
        });

        elements.typingInput.addEventListener('input', (e) => {
            if (!gameState.gameActive) return;
            
            gameState.userInput = e.target.value;
            updateInputPreview();
            updateInputStyle();
            checkInput();
        });

        // ÂàùÊúüÂåñ
        selectNewWord();
        updateDisplay();
    </script>
</body>
</html>